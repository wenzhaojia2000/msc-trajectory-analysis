<!DOCTYPE html>
<html>
   <head>
      <title>Quantics Analysis GUI</title>
      <meta charset="utf-8" />
      <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
      <link href="stylesheet.css" rel="stylesheet" type="text/css" />
   </head>
   <body>
      <h1 id="title">Quantics Analysis GUI &mdash; User documentation</h1>
      <p>The Quantics Analysis GUI is an alternative for using the existing quantics analysis commands on a command line interface. It serves as an easier and more user-friendly way to perform analysis on the output of a quantics simulation.</p>

      <ul>
            <li><a href="#getting_started">Getting started</a></li>
            <ul>
                  <li><a href="#dir_edit">Opening a directory</a></li>
                  <li><a href="#analyse">Performing an analysis</a></li>
                  <li><a href="#coord_select">Coordinate selection</a></li>
                  <li><a href="#further_info">Specific information on an analysis</a></li>
                  <li><a href="#plot_widget">The plot widget</a></li>
                  <li><a href="#animated_plots">Animated plots</a></li>
            </ul>
            <li><a href="#context_menu">Context menus</a></li>
            <ul>
                  <li><a href="#customise_plot">Customising the plot widget</a></li>
                  <li><a href="#saving">Saving files, images, and videos</a></li>
                  <li><a href="#line_wrap">Line wrap</a></li>
                  <li><a href="#transform">Transformations</a></li>
            </ul>
            <li><a href="#options_menu">Options menu</a></li>
            <ul>
                  <li><a href="#timeout">Timeout</a></li>
                  <li><a href="#cleanup">Cleanup directory</a></li>
                  <li><a href="#add_flags">Allow additional flags</a></li>
                  <li><a href="#no_command">No command mode</a></li>
            </ul>
      </ul>

      <h2 id="getting_started">Getting started</h2>
      <p>The GUI requires python &geq; 3.10 and the packages <u>PyQt5</u> and <u>pyqtgraph</u> to function (installing pyqtgraph should also install numpy, which is also required). If you do not yet have python installed, it is recommended to use <a href="https://docs.conda.io/projects/conda/en/stable/user-guide/install/linux.html">conda</a>. A conda environment with the prerequisites is available by navigating to <code>%QUANTICS_DIR%/source/analyse/analysis_gui/</code> and executing</p>
      <pre>
conda env create -f environment.yml</pre>
      <p>If the environment is already created, you can use</p>
      <pre>
conda activate quantics_gui</pre>
      <p>Open the GUI by using</p>
      <pre>
python3 %QUANTICS_DIR%/source/analyse/quantics_analysis_gui.py</pre>
      <p>If you do not wish to use conda, you can install the required packages directly using pip:</p>
      <pre>
python3 -m pip install PyQt5 pyqtgraph</pre>

      <h3 id="dir_edit">Opening a directory</h3>
      <p>After successfully using the <code>quantics</code> command, a folder should have been generated with output files. To navigate to the folder in the GUI, you can click <span class="button">File</span> &rightarrow; <span class="button">Open Directory</span>, type <code>Ctrl + O</code>, or the click on the button in the top-right corner. Alternatively, you can paste the directory directly into the &lsquo;Current directory&rsquo; line.</p>
      <video width="524" height="325" playsinline muted autoplay loop><source src="media/dir_edit.mp4" type="video/mp4"></video>
      
      <h3 id="analyse">Performing an analysis</h3>
      <p>On the left side of the screen, various analyses have been split into different sections. To perform an analysis, click on one of the tabs (namely Analyse Convergence, Analyse System, etc.) and click on the radio button with the analysis you want. Some options have an additional options box that control the inputs to the fuction (e.g. specifying the state to look at). When you are ready, click <span class="button">Continue</span>.</p>

      <p>The output is on the right side of the screen. Depending on the analysis chosen, the output is written to the plot widget or the text widget. Most analyses change the plot widget, in which case the text widget shows the standard output (<code>stdout</code>) of the command if you had used it on the command line, or the <code>.log</code> file generated from the command. You can switch between the two at the bottom of the screen.</p>
      <video width="524" height="325" playsinline muted autoplay loop><source src="media/analyse.mp4" type="video/mp4"></video>

      <p>Once you have finished with analysis, you may wish to delete extra files generated by the GUI (see <a href="#cleanup_directory">Cleanup Directory</a>).</p>

      <h3 id="coord_select">Coordinate selection</h3>
      <p>In order to plot multi-dimensional data, a &lsquo;cut&rsquo; of the data may have to be performed. This is done using the coordinate selection option in the extra options box. You can choose the degree of freedoms that are <i>x</i> and <i>y</i>, then choose fixed values for the other DOFs. If both <i>x</i> and <i>y</i> are selected, a contour plot is produced. If only <i>x</i>, a normal line graph.</p>
      <video width="524" height="325" playsinline muted autoplay loop><source src="media/coord_select.mp4" type="video/mp4"></video>

      <h3 id="further_info">Specific information on an analysis</h3>
      <p>You can hover over one of the analysis radio buttons to get an overview of what it does. If the message is in the form &lsquo;Executes [command]&rsquo;, the GUI will internally call the quantics command. You can then look up information for that command in the <a href="../analyse.html">original analysis documentation</a>.</p>

      <h3 id="plot_widget">The plot widget</h3>
      <p>You can move the data in the plot by holding left-click and dragging around. To zoom in, right-click and drag horizontally to zoom the x-axis, vertically to zoom the y-axis, or diagonally for a combination. You may also use the middle mouse buttom for this purpose.</p>

      <p>Alternatively, right-click and click <span class="button">Mouse mode</span> &rightarrow; <span class="button">1 button</span>, which replaces the left-click with a zoom option; simply drag a box around the part of the graph you want to zoom into. To return to automatic sizing, right click and click <span class="button">View all</span> or click the <span class="button">A</span> in the bottom left of the widget.</p>

      <p>If you have the legend open (which it is by default), you can click on the lines in the legend to hide plotting for that line. This is useful if the plotted data overlaps heavily and you want to look at one line in particular, for example.</p>
      <video width="524" height="325" playsinline muted autoplay loop><source src="media/plot_widget.mp4" type="video/mp4"></video>

      <h3 id="animated_plots">Animated plots</h3>
      <p>Some analysis options allow you to control time using the &lsquo;scrubber&rsquo; at the bottom of the screen. You can also click the play button to automatically increase time in the plot. Control how fast this goes using the <span class="button">Speed</span> button. This button also changes the framerate if you <a href="saving_files">save the video</a> as well.</p>

      <p>For animated 1D plots, the y-axis rescales automatically over time. To prevent this, right-click, go to <span class="button">Y axis</span> and click <span class="button">Manual</span> to fix the y-axis limits to their current values.</p>
      <video width="524" height="325" playsinline muted autoplay loop><source src="media/animated_plots.mp4" type="video/mp4"></video>

      <h2 id="context_menu">Context menus</h2>
      <p>Context menus are shown when right-clicking on the text widget or the plot widget.</p>

      <h3 id="customise_plot">Customising the plot widget</h3>
      <p>It is possible to change the some properties of the plot by right-clicking &rightarrow; <span class="button">Plot Options</span>. In this sub-menu, you can change the title of the plot (<span class="button">Custom title</span>), whether to show the legend (<span class="button">Show legend</span>) as well as enabling the grid/changing its opacity (<span class="button">Grid</span>).</p>

      <p>The GUI is not intended to produce publication quality graphics. If more customisation is needed, it is recommended to save the .npy data (see section below) then use a package such as matplotlib to read the data and produce your own graphics.</p>
      <video width="524" height="325" playsinline muted autoplay loop><source src="media/customise_plot.mp4" type="video/mp4"></video>

      <h3 id="saving">Saving files, images, and videos</h3>
      <p>You can save the text output in the text widget by right-clicking &rightarrow; <span class="button">Save text</span>, or the raw numpy data in a plot with <span class="button">Save .npy data</span>. A menu should pop up asking you the name and location of the file you want to save.</p>

      <p>In order to save an image of the current plot, right-click and choose <span class="button">Export...</span> in the plot widget&rsquo;s context menu. Then you can choose whether to save as an image (png, jpg) or a vector graphic (svg) of the current window. In order to save a video, you must have ffmpeg installed, which can be obtained from your package manager, e.g. for apt,</p>
      <pre>
sudo apt install ffmpeg</pre>
      <p>after which you can save similarly to the other options.</p>

      <p>To make images/videos larger or smaller, simply resize the window accordingly.</p>
      <video width="524" height="325" playsinline muted autoplay loop><source src="media/saving.mp4" type="video/mp4"></video>

      <h3 id="line_wrap">Line wrap</h3>
      <p>In the text widget, if there are too many characters on one line, a horizontal scroll bar will show up to see the rest of the line. If you do not want this, you can enable this option to split any long lines over multiple lines.</p>

      <h3 id="transform">Transformations</h3>
      <p>A number of transformations can be applied to the current plot by right-clicking &rightarrow; <span class="button">Plot Options</span> &rightarrow; <span class="button">Transforms</span>. Some convenient ones include log X, log Y, and dy/dx.</p>
      <video width="524" height="325" playsinline muted autoplay loop><source src="media/transform.mp4" type="video/mp4"></video>

      <h2 id="options_menu">Options menu</h2>
      <p>The options menu is on the menu bar on the top of the GUI.</p>

      <h3 id="timeout">Timeout</h3>
      <p>When performing an analysis, the GUI calls the quantics analysis programs internally. The <i>timeout</i> option sets how long to GUI waits for the analysis program to finish before giving up. Note, this option only applies to the quantics analysis program and not any analysis the GUI does itself.</p>

      <h3 id="cleanup">Cleanup directory</h3>
      <p>Some calls to quantics analysis programs leave data files for the GUI to read. These files are analysis output files (not to be confused with the output files from quantics), and are read by the GUI for plotting purposes. After an analysis is finished, these files are <b>not</b> removed automatically. If you wish to remove them, click <span class="button">Options</span> &rightarrow; <span class="button">Cleanup directory</span>. The GUI finds any analysis output files in the current directory and deletes them (after asking for your permission, of course).</p>
      <video width="524" height="325" playsinline muted autoplay loop><source src="media/cleanup.mp4" type="video/mp4"></video>

      <h3 id="add_flags">Allow additional flags</h3>
      <p>For certain analyses, an options box may show up with more controls. In general, these toggle the flags and inputs to the corresponding quantics analysis program. However, not all options may be covered, and for technical users, you can manually input additional flags by using <span class="button">Options</span> &rightarrow; <span class="button">Allow additional flags</span>. An additional box will show at the bottom of the analysis toolbar for you to enter these extra options.</p>

      <p>An example where this may be useful is if you want to use the <code>restart</code> file rather than the <code>psi</code> file. Select the relevant command, then type <code>-r</code> into the additional flags box, before continuing as normal.</p>

      <h3 id="no_command">No command mode</h3>
      <p>This option is convenient if you already have the quantics analysis output already, and want to show it in the GUI without calling the quantics analysis program again. If this option is on, the GUI will try to read the relevant file without calling the corresponding quantics program.</p>

      <p>This may be useful if the analysis program takes a long time to compute. You can call the original command on the CLI, then wait in the background for it to finish, or SSH into a HPC cluster and call it there. Once it has completed, navigate to the directory of the output file and select the relevant command in the GUI, then continue as normal in no command mode. The GUI should plot the output normally.</p>

      <p>For certain analyses, the extra options must be set correctly, e.g. for the 1D density, the degree of freedom and state selected must match with the filename.</p>

   </body>
</html>